{{#extend "admin_base"}}

  {{#content "title"}} - Admin{{/content}}


  {{#content "pagebody"}}

  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h1 class="page-header">Article List</h1>

        <div class="panel panel-default">

          <div class="panel-heading">
            Article List
          </div>

          <div class="panel-body">

            <table class="table table-hover table-bordered" id="article-table">
              <thead>
                <th>#</th>
                <th>title</th>
                <th>publish_time</th>
                <th>content</th>
              </thead>
              <tbody>
                <!-- default data -->
                <!-- <tr> -->
                <!--   <td>1</td> -->
                <!--   <td>uvuvewvwev</td> -->
                <!--   <td>1970-01-01</td> -->
                <!--   <td>nyaaaaaaan</td> -->
                <!-- </tr> -->
              </tbody>
            </table>

          </div>
          <!-- panel-body -->

        </div>
        <!-- panel-default -->

      </div>
      <!-- col -->

    </div>
    <!-- row -->

  </div>
  <!-- container -->

  {{/content}}


  {{#content "inlinejs"}}
  <script type="text/javascript">

    $(document).ready(function() {
      // HACK: query start_time, binded to the current page object,
      //       should be early enough
      document.gCurrentStartTime = new Date('1970-01-10');
      // retrieve data from server
      $.ajax({
        url: "/article_list/list",
        method: "GET",
        data: {
          "start_time": document.gCurrentStartTime
        },
        success: (data) => {
          if (data.code === 200) {    // success code
            // console.log(data.data);
            let table = $("#article-table").DataTable({
              responsive: true,
              lengthMenu: [
                [10, 25, 50, 1e+20],
                ["Less", "Medium", "More", "All"]
              ],
              data: data.data,
              columns: [
                { "data": "ID" },
                { "data": "title" },
                { "data": "publish_time" },
                { "data": "content" }
              ]
            });
            // bind custom events
            table.on("length.dt", function(e, settings, length) {
              console.log(`page length changed to ${length}`);
            });
          } else {    // request error
            console.log(`Request Failed with: `, data);
          }
        },
        error: (ret) => {
          console.log(ret);
        }
      });
    });

  </script>
  {{/content}}

{{/extend}}
